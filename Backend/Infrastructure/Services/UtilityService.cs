using Application.DTOs;
using Application.Interfaces;

namespace Infrastructure.Services;

public class UtilityService : IUtilityService
{
    private readonly Dictionary<string, List<string>> _biharDistrictPincodes;

    public UtilityService()
    {
        _biharDistrictPincodes = new Dictionary<string, List<string>>
        {
            { "Patna", new List<string> { "800001", "800002", "800003", "800004", "800005", "800006", "800007", "800008", "800009", "800010", "800011", "800012", "800013", "800014", "800015", "800016", "800017", "800018", "800019", "800020", "800021", "800022", "800023", "800024", "800025", "800026", "800027", "800028", "800029", "800030" } },
            { "Gaya", new List<string> { "823001", "823002", "823003", "823004", "823005", "823006", "823007", "823008", "823009", "823010", "824201", "824202", "824203", "824204", "824205", "824206", "824207", "824208", "824209", "824210" } },
            { "Muzaffarpur", new List<string> { "842001", "842002", "842003", "842004", "842005", "842006", "842007", "842008", "842009", "842010", "843101", "843102", "843103", "843104", "843105", "843106", "843107", "843108", "843109", "843110" } },
            { "Darbhanga", new List<string> { "846001", "846002", "846003", "846004", "846005", "846006", "846007", "846008", "846009", "846010", "847101", "847102", "847103", "847104", "847105", "847106", "847107", "847108", "847109", "847110" } },
            { "Bhagalpur", new List<string> { "812001", "812002", "812003", "812004", "812005", "812006", "812007", "812008", "812009", "812010", "813101", "813102", "813103", "813104", "813105", "813106", "813107", "813108", "813109", "813110" } },
            { "Purnia", new List<string> { "854301", "854302", "854303", "854304", "854305", "854306", "854307", "854308", "854309", "854310", "855101", "855102", "855103", "855104", "855105", "855106", "855107", "855108", "855109", "855110" } },
            { "Saran", new List<string> { "841301", "841302", "841303", "841304", "841305", "841306", "841307", "841308", "841309", "841310", "841401", "841402", "841403", "841404", "841405", "841406", "841407", "841408", "841409", "841410" } },
            { "Begusarai", new List<string> { "851101", "851102", "851103", "851104", "851105", "851106", "851107", "851108", "851109", "851110", "851201", "851202", "851203", "851204", "851205", "851206", "851207", "851208", "851209", "851210" } },
            { "Katihar", new List<string> { "854105", "854106", "854107", "854108", "854109", "854110", "854111", "854112", "854113", "854114", "854201", "854202", "854203", "854204", "854205", "854206", "854207", "854208", "854209", "854210" } },
            { "Bhojpur", new List<string> { "802301", "802302", "802303", "802304", "802305", "802306", "802307", "802308", "802309", "802310", "802211", "802212", "802213", "802214", "802215", "802216", "802217", "802218", "802219", "802220" } },
            { "Nalanda", new List<string> { "803101", "803102", "803103", "803104", "803105", "803106", "803107", "803108", "803109", "803110", "803201", "803202", "803203", "803204", "803205", "803206", "803207", "803208", "803209", "803210" } },
            { "Aurangabad", new List<string> { "824101", "824102", "824103", "824104", "824105", "824106", "824107", "824108", "824109", "824110", "824201", "824202", "824203", "824204", "824205", "824206", "824207", "824208", "824209", "824210" } },
            { "Jehanabad", new List<string> { "804401", "804402", "804403", "804404", "804405", "804406", "804407", "804408", "804409", "804410", "804501", "804502", "804503", "804504", "804505", "804506", "804507", "804508", "804509", "804510" } },
            { "Arwal", new List<string> { "804401", "804402", "804403", "804404", "804405", "804406", "804407", "804408", "804409", "804410", "804501", "804502", "804503", "804504", "804505", "804506", "804507", "804508", "804509", "804510" } },
            { "Rohtas", new List<string> { "821301", "821302", "821303", "821304", "821305", "821306", "821307", "821308", "821309", "821310", "821401", "821402", "821403", "821404", "821405", "821406", "821407", "821408", "821409", "821410" } },
            { "Kaimur", new List<string> { "821101", "821102", "821103", "821104", "821105", "821106", "821107", "821108", "821109", "821110", "821201", "821202", "821203", "821204", "821205", "821206", "821207", "821208", "821209", "821210" } },
            { "Buxar", new List<string> { "802101", "802102", "802103", "802104", "802105", "802106", "802107", "802108", "802109", "802110", "802201", "802202", "802203", "802204", "802205", "802206", "802207", "802208", "802209", "802210" } },
            { "Siwan", new List<string> { "841226", "841227", "841228", "841229", "841230", "841231", "841232", "841233", "841234", "841235", "841301", "841302", "841303", "841304", "841305", "841306", "841307", "841308", "841309", "841310" } },
            { "Gopalganj", new List<string> { "841428", "841429", "841430", "841431", "841432", "841433", "841434", "841435", "841436", "841437", "841501", "841502", "841503", "841504", "841505", "841506", "841507", "841508", "841509", "841510" } },
            { "East Champaran", new List<string> { "845101", "845102", "845103", "845104", "845105", "845106", "845107", "845108", "845109", "845110", "845201", "845202", "845203", "845204", "845205", "845206", "845207", "845208", "845209", "845210" } },
            { "West Champaran", new List<string> { "845438", "845439", "845440", "845441", "845442", "845443", "845444", "845445", "845446", "845447", "845501", "845502", "845503", "845504", "845505", "845506", "845507", "845508", "845509", "845510" } },
            { "Sitamarhi", new List<string> { "843301", "843302", "843303", "843304", "843305", "843306", "843307", "843308", "843309", "843310", "843401", "843402", "843403", "843404", "843405", "843406", "843407", "843408", "843409", "843410" } },
            { "Sheohar", new List<string> { "843329", "843330", "843331", "843332", "843333", "843334", "843335", "843336", "843337", "843338", "843401", "843402", "843403", "843404", "843405", "843406", "843407", "843408", "843409", "843410" } },
            { "Madhubani", new List<string> { "847401", "847402", "847403", "847404", "847405", "847406", "847407", "847408", "847409", "847410", "847501", "847502", "847503", "847504", "847505", "847506", "847507", "847508", "847509", "847510" } },
            { "Supaul", new List<string> { "847239", "847240", "847241", "847242", "847243", "847244", "847245", "847246", "847247", "847248", "847301", "847302", "847303", "847304", "847305", "847306", "847307", "847308", "847309", "847310" } },
            { "Saharsa", new List<string> { "852201", "852202", "852203", "852204", "852205", "852206", "852207", "852208", "852209", "852210", "852301", "852302", "852303", "852304", "852305", "852306", "852307", "852308", "852309", "852310" } },
            { "Madhepura", new List<string> { "852113", "852114", "852115", "852116", "852117", "852118", "852119", "852120", "852121", "852122", "852201", "852202", "852203", "852204", "852205", "852206", "852207", "852208", "852209", "852210" } },
            { "Araria", new List<string> { "854311", "854312", "854313", "854314", "854315", "854316", "854317", "854318", "854319", "854320", "854401", "854402", "854403", "854404", "854405", "854406", "854407", "854408", "854409", "854410" } },
            { "Kishanganj", new List<string> { "855107", "855108", "855109", "855110", "855111", "855112", "855113", "855114", "855115", "855116", "855201", "855202", "855203", "855204", "855205", "855206", "855207", "855208", "855209", "855210" } },
            { "Banka", new List<string> { "813102", "813103", "813104", "813105", "813106", "813107", "813108", "813109", "813110", "813111", "813201", "813202", "813203", "813204", "813205", "813206", "813207", "813208", "813209", "813210" } },
            { "Munger", new List<string> { "811201", "811202", "811203", "811204", "811205", "811206", "811207", "811208", "811209", "811210", "811301", "811302", "811303", "811304", "811305", "811306", "811307", "811308", "811309", "811310" } },
            { "Lakhisarai", new List<string> { "811311", "811312", "811313", "811314", "811315", "811316", "811317", "811318", "811319", "811320", "811401", "811402", "811403", "811404", "811405", "811406", "811407", "811408", "811409", "811410" } },
            { "Sheikhpura", new List<string> { "811105", "811106", "811107", "811108", "811109", "811110", "811111", "811112", "811113", "811114", "811201", "811202", "811203", "811204", "811205", "811206", "811207", "811208", "811209", "811210" } },
            { "Khagaria", new List<string> { "851204", "851205", "851206", "851207", "851208", "851209", "851210", "851211", "851212", "851213", "851301", "851302", "851303", "851304", "851305", "851306", "851307", "851308", "851309", "851310" } },
            { "Samastipur", new List<string> { "848101", "848102", "848103", "848104", "848105", "848106", "848107", "848108", "848109", "848110", "848201", "848202", "848203", "848204", "848205", "848206", "848207", "848208", "848209", "848210" } },
            { "Vaishali", new List<string> { "844101", "844102", "844103", "844104", "844105", "844106", "844107", "844108", "844109", "844110", "844201", "844202", "844203", "844204", "844205", "844206", "844207", "844208", "844209", "844210" } },
            { "Jamui", new List<string> { "811307", "811308", "811309", "811310", "811311", "811312", "811313", "811314", "811315", "811316", "811401", "811402", "811403", "811404", "811405", "811406", "811407", "811408", "811409", "811410" } },
            { "Nawada", new List<string> { "805110", "805111", "805112", "805113", "805114", "805115", "805116", "805117", "805118", "805119", "805201", "805202", "805203", "805204", "805205", "805206", "805207", "805208", "805209", "805210" } }
        };
    }

    public async Task<IEnumerable<DistrictDto>> GetBiharDistrictsAsync()
    {
        return await Task.FromResult(_biharDistrictPincodes.Select(kvp => new DistrictDto
        {
            Name = kvp.Key,
            Pincodes = kvp.Value
        }).OrderBy(d => d.Name));
    }

    public async Task<IEnumerable<PincodeDto>> GetPincodesByDistrictAsync(string district)
    {
        if (_biharDistrictPincodes.TryGetValue(district, out var pincodes))
        {
            return await Task.FromResult(pincodes.Select(p => new PincodeDto
            {
                Pincode = p,
                District = district
            }));
        }
        return await Task.FromResult(Enumerable.Empty<PincodeDto>());
    }

    public async Task<string?> GetDistrictByPincodeAsync(string pincode)
    {
        var district = _biharDistrictPincodes.FirstOrDefault(kvp => kvp.Value.Contains(pincode)).Key;
        return await Task.FromResult(district);
    }
}